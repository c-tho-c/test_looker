!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dynamicTable=e():n.dynamicTable=e()}(self,()=>(()=>{"use strict";var n={56:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},72:n=>{var e=[];function t(n){for(var t=-1,o=0;o<e.length;o++)if(e[o].identifier===n){t=o;break}return t}function o(n,o){for(var a={},i=[],l=0;l<n.length;l++){var s=n[l],c=o.base?s[0]+o.base:s[0],A=a[c]||0,d="".concat(c," ").concat(A);a[c]=A+1;var p=t(d),h={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var g=r(h,o);o.byIndex=l,e.splice(l,0,{identifier:d,updater:g,references:1})}i.push(d)}return i}function r(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,r){var a=o(n=n||[],r=r||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var l=t(a[i]);e[l].references--}for(var s=o(n,r),c=0;c<a.length;c++){var A=t(a[c]);0===e[A].references&&(e[A].updater(),e.splice(A,1))}a=s}}},113:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},314:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t="",o=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),o&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),o&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t}).join("")},e.i=function(n,t,o,r,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(o)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<n.length;c++){var A=[].concat(n[c]);o&&i[A[0]]||(void 0!==a&&(void 0===A[5]||(A[1]="@layer".concat(A[5].length>0?" ".concat(A[5]):""," {").concat(A[1],"}")),A[5]=a),t&&(A[2]?(A[1]="@media ".concat(A[2]," {").concat(A[1],"}"),A[2]=t):A[2]=t),r&&(A[4]?(A[1]="@supports (".concat(A[4],") {").concat(A[1],"}"),A[4]=r):A[4]="".concat(r)),e.push(A))}},e}},354:n=>{n.exports=function(n){var e=n[1],t=n[3];if(!t)return e;if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),a="/*# ".concat(r," */");return[e].concat([a]).join("\n")}return[e].join("\n")}},365:(n,e,t)=>{t.d(e,{A:()=>l});var o=t(354),r=t.n(o),a=t(314),i=t.n(a)()(r());i.push([n.id,":root {\n  --color-positive: #16a34a;\n  --color-positive-bg: #dcfce7;\n  --color-negative: #dc2626;\n  --color-negative-bg: #fee2e2;\n  --color-neutral: #6b7280;\n  --color-primary: #3b82f6;\n  --color-bg-primary: #ffffff;\n  --color-bg-secondary: #fafafa;\n  --color-border: #e5e7eb;\n  --color-text-primary: #1f2937;\n  --color-text-secondary: #6b7280;\n  --spacing-xs: 4px;\n  --spacing-sm: 8px;\n  --spacing-md: 12px;\n  --spacing-lg: 20px;\n  --border-radius: 4px;\n  --transition-speed: 0.15s;\n}\n\n.dynamic-table-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  background: transparent;\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  box-sizing: border-box;\n}\n\n.loading-viz, .error-state, .empty-state {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  min-height: 200px;\n  font-size: 14px;\n  padding: 20px;\n  text-align: center;\n  box-sizing: border-box;\n}\n\n.loading-viz {\n  color: #6b7280;\n}\n\n.error-state {\n  color: #ef4444;\n}\n\n.empty-state {\n  color: #9ca3af;\n}\n\n/* Toggle Controls */\n.table-controls {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: var(--spacing-md);\n  background: transparent;\n  border-bottom: 1px solid var(--color-border);\n}\n\n.expand-toggle {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  background: var(--color-bg-primary);\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  color: var(--color-text-primary);\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all var(--transition-speed) ease;\n}\n\n.expand-toggle:hover {\n  background: var(--color-bg-secondary);\n  border-color: var(--color-primary);\n}\n\n.expand-toggle:active {\n  transform: scale(0.98);\n}\n\n.expand-toggle-icon {\n  font-size: 12px;\n}\n\n.table-wrapper {\n  overflow: auto;\n  background: var(--color-bg-primary);\n  flex: 1;\n  min-height: 0;\n  width: 100%;\n  position: relative;\n}\n\n.dynamic-table {\n  width: max-content;\n  min-width: 100%;\n  border-collapse: collapse;\n  background: #ffffff;\n  font-size: 13px;\n  table-layout: auto;\n}\n\n/* Header Styles */\n.dynamic-table thead {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: #ffffff;\n}\n\n/* Sticky first column (hierarchy) on left */\n.dynamic-table th.hierarchy-header,\n.dynamic-table td.hierarchy-cell {\n  position: sticky;\n  left: 0;\n  z-index: 5;\n  background: #ffffff;\n  box-shadow: 2px 0 4px rgba(0, 0, 0, 0.05);\n}\n\n.dynamic-table th.hierarchy-header {\n  z-index: 15;\n}\n\n/* Sticky right columns (Total général) */\n.dynamic-table th.sticky-right-col,\n.dynamic-table td.sticky-right-col {\n  position: sticky;\n  right: 0;\n  z-index: 4;\n  background: #ffffff;\n  box-shadow: -2px 0 4px rgba(0, 0, 0, 0.05);\n}\n\n.dynamic-table th.sticky-right-col {\n  z-index: 14;\n}\n\n/* Adjust shadows for better visibility */\n.dynamic-table tbody tr:hover td.hierarchy-cell,\n.dynamic-table tbody tr:hover td.sticky-right-col {\n  background: #f9fafb;\n}\n\n.dynamic-table thead tr {\n  border-bottom: 1px solid var(--color-border);\n}\n\n.dynamic-table th {\n  padding: 10px 12px;\n  text-align: left;\n  font-weight: 600;\n  font-size: 12px;\n  color: var(--color-text-secondary);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  white-space: nowrap;\n  background: var(--color-bg-primary);\n  border-right: 1px solid #e5e7eb;\n}\n\n.dynamic-table th:last-child {\n  border-right: none;\n}\n\n/* Group header row styling */\n.group-header-row th {\n  padding: 8px 12px;\n  font-size: 13px;\n  font-weight: 700;\n  border-bottom: 1px solid #d1d5db;\n}\n\n/* FNAC group styling */\nth[data-group*=\"FNAC\"] {\n  background-color: #fde68a !important;\n  color: #92400e !important;\n}\n\n/* DARTY group styling */\nth[data-group*=\"DARTY\"] {\n  background-color: #ef4444 !important;\n  color: #ffffff !important;\n}\n\n/* Total group styling */\nth[data-group*=\"Total\"],\nth[data-group*=\"général\"] {\n  background-color: #e5e7eb !important;\n  color: #374151 !important;\n}\n\n.hierarchy-header {\n  min-width: 180px;\n  max-width: 280px;\n  padding-left: var(--spacing-md) !important;\n  text-align: left !important;\n  background: #ffffff !important;\n  font-weight: 600 !important;\n  white-space: nowrap;\n}\n\n.measure-header {\n  text-align: right !important;\n  min-width: 80px;\n  max-width: 130px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.measure-header.sortable {\n  cursor: pointer;\n  user-select: none;\n  transition: background-color 0.15s ease;\n}\n\n.measure-header.sortable:hover {\n  filter: brightness(0.95);\n}\n\n.measure-header.sortable:active {\n  filter: brightness(0.9);\n}\n\n.sort-indicator {\n  font-size: 10px;\n  opacity: 0.3;\n  transition: opacity 0.15s ease;\n}\n\n/* Body Styles */\n.dynamic-table tbody tr {\n  transition: background-color var(--transition-speed) ease;\n  border-bottom: 1px solid #f3f4f6;\n}\n\n.dynamic-table tbody tr:hover {\n  background-color: #fafafa;\n}\n\n.dynamic-table tbody tr:last-child {\n  border-bottom: 1px solid var(--color-border);\n}\n\n/* Subtotal Row Styles */\n.subtotal-row {\n  background: #f9fafb !important;\n  font-weight: 600;\n  border-top: 2px solid #d1d5db !important;\n  border-bottom: 2px solid #d1d5db !important;\n}\n\n.subtotal-row:hover {\n  background: #f3f4f6 !important;\n}\n\n.subtotal-cell {\n  font-weight: 600 !important;\n  color: #374151 !important;\n}\n\n.subtotal-label {\n  font-weight: 600;\n  font-style: italic;\n  color: #6b7280;\n}\n\n/* Cell Styles */\n.dynamic-table td {\n  padding: 6px 8px;\n  font-size: 12px;\n  color: var(--color-text-primary);\n  white-space: nowrap;\n}\n\n.dynamic-table th {\n  padding: 8px;\n  font-size: 12px;\n}\n\n/* Hierarchy Cell */\n.hierarchy-cell {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding-left: 8px !important;\n  background: #ffffff;\n  white-space: nowrap;\n  max-width: 280px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.indent {\n  display: inline-block;\n  flex-shrink: 0;\n}\n\n.expander {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 14px;\n  height: 14px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  font-size: 9px;\n  border-radius: 2px;\n  transition: all var(--transition-speed) ease;\n  flex-shrink: 0;\n}\n\n.expander:hover {\n  background-color: var(--color-bg-secondary);\n  color: var(--color-text-primary);\n}\n\n.expander.expanded {\n  color: var(--color-text-primary);\n}\n\n.expander.collapsed {\n  color: var(--color-text-secondary);\n}\n\n.expander-spacer {\n  display: inline-block;\n  width: 20px;\n  flex-shrink: 0;\n}\n\n.node-label {\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Level-based indentation styling */\n.level-0 .node-label {\n  font-weight: 600;\n  font-size: 13px;\n  color: var(--color-text-primary);\n}\n\n.level-1 .node-label {\n  font-weight: 500;\n  font-size: 13px;\n}\n\n.level-2 .node-label {\n  font-weight: 400;\n  font-size: 13px;\n  color: var(--color-text-secondary);\n}\n\n/* Measure Cell */\n.measure-cell {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n  white-space: nowrap;\n  font-weight: 400;\n}\n\n.measure-cell .value {\n  margin-right: var(--spacing-xs);\n}\n\n/* Change Badge (Boxed Evolution Indicator) */\n.change-badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 3px 6px;\n  border-radius: 3px;\n  font-size: 11px;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n.change-badge.positive {\n  background-color: var(--color-positive-bg);\n  color: var(--color-positive);\n}\n\n.change-badge.negative {\n  background-color: var(--color-negative-bg);\n  color: var(--color-negative);\n}\n\n.change-badge.neutral {\n  background-color: #f3f4f6;\n  color: var(--color-neutral);\n}\n\n/* Arrows in badges */\n.badge-arrow {\n  font-size: 11px;\n  line-height: 1;\n}\n\n/* Legacy positive/negative without badge */\n.measure-cell.positive:not(:has(.change-badge)) {\n  color: var(--color-positive);\n}\n\n.measure-cell.negative:not(:has(.change-badge)) {\n  color: var(--color-negative);\n}\n\n/* Remove bounce animations for minimalistic style */\n\n/* Clickable cells (with drill) */\n.measure-cell.clickable {\n  cursor: pointer;\n  position: relative;\n}\n\n.measure-cell.clickable:hover {\n  background-color: var(--color-bg-secondary);\n}\n\n/* Empty State */\n.empty-state {\n  padding: var(--spacing-lg);\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 13px;\n  font-weight: 400;\n}\n\n/* Loading State */\n.loading {\n  padding: var(--spacing-lg);\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 13px;\n}\n\n/* Scrollbar Styling */\n.dynamic-table-container::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-track {\n  background: var(--color-bg-secondary);\n  border-radius: 4px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-thumb {\n  background: var(--color-border);\n  border-radius: 4px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-thumb:hover {\n  background: var(--color-text-secondary);\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n  .dynamic-table-container {\n    padding: var(--spacing-sm);\n  }\n\n  .dynamic-table th,\n  .dynamic-table td {\n    padding: var(--spacing-sm) var(--spacing-xs);\n    font-size: 12px;\n  }\n\n  .hierarchy-header {\n    min-width: 150px;\n  }\n\n  .measure-header {\n    min-width: 80px;\n  }\n}\n\n/* Pagination Styles */\n.pagination-controls {\n  padding: 12px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-top: 1px solid var(--color-border);\n  font-size: 13px;\n  color: var(--color-text-secondary);\n  background: transparent;\n}\n\n.pagination-button {\n  padding: 6px 12px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  background: #ffffff;\n  color: var(--color-text-primary);\n  font-size: 13px;\n  font-weight: 500;\n  transition: all 0.15s ease;\n}\n\n.pagination-button:hover:not(:disabled) {\n  background: var(--color-bg-secondary);\n  border-color: var(--color-primary);\n}\n\n.pagination-button:disabled {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n\n/* Print Styles */\n@media print {\n  .dynamic-table-container {\n    overflow: visible;\n  }\n\n  .dynamic-table {\n    box-shadow: none;\n  }\n\n  .expander {\n    display: none;\n  }\n  \n  .pagination-controls {\n    display: none;\n  }\n}\n","",{version:3,sources:["webpack://./src/styles.css"],names:[],mappings:"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",sourcesContent:[":root {\n  --color-positive: #16a34a;\n  --color-positive-bg: #dcfce7;\n  --color-negative: #dc2626;\n  --color-negative-bg: #fee2e2;\n  --color-neutral: #6b7280;\n  --color-primary: #3b82f6;\n  --color-bg-primary: #ffffff;\n  --color-bg-secondary: #fafafa;\n  --color-border: #e5e7eb;\n  --color-text-primary: #1f2937;\n  --color-text-secondary: #6b7280;\n  --spacing-xs: 4px;\n  --spacing-sm: 8px;\n  --spacing-md: 12px;\n  --spacing-lg: 20px;\n  --border-radius: 4px;\n  --transition-speed: 0.15s;\n}\n\n.dynamic-table-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  background: transparent;\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  box-sizing: border-box;\n}\n\n.loading-viz, .error-state, .empty-state {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  min-height: 200px;\n  font-size: 14px;\n  padding: 20px;\n  text-align: center;\n  box-sizing: border-box;\n}\n\n.loading-viz {\n  color: #6b7280;\n}\n\n.error-state {\n  color: #ef4444;\n}\n\n.empty-state {\n  color: #9ca3af;\n}\n\n/* Toggle Controls */\n.table-controls {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: var(--spacing-md);\n  background: transparent;\n  border-bottom: 1px solid var(--color-border);\n}\n\n.expand-toggle {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  background: var(--color-bg-primary);\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  color: var(--color-text-primary);\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all var(--transition-speed) ease;\n}\n\n.expand-toggle:hover {\n  background: var(--color-bg-secondary);\n  border-color: var(--color-primary);\n}\n\n.expand-toggle:active {\n  transform: scale(0.98);\n}\n\n.expand-toggle-icon {\n  font-size: 12px;\n}\n\n.table-wrapper {\n  overflow: auto;\n  background: var(--color-bg-primary);\n  flex: 1;\n  min-height: 0;\n  width: 100%;\n  position: relative;\n}\n\n.dynamic-table {\n  width: max-content;\n  min-width: 100%;\n  border-collapse: collapse;\n  background: #ffffff;\n  font-size: 13px;\n  table-layout: auto;\n}\n\n/* Header Styles */\n.dynamic-table thead {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: #ffffff;\n}\n\n/* Sticky first column (hierarchy) on left */\n.dynamic-table th.hierarchy-header,\n.dynamic-table td.hierarchy-cell {\n  position: sticky;\n  left: 0;\n  z-index: 5;\n  background: #ffffff;\n  box-shadow: 2px 0 4px rgba(0, 0, 0, 0.05);\n}\n\n.dynamic-table th.hierarchy-header {\n  z-index: 15;\n}\n\n/* Sticky right columns (Total général) */\n.dynamic-table th.sticky-right-col,\n.dynamic-table td.sticky-right-col {\n  position: sticky;\n  right: 0;\n  z-index: 4;\n  background: #ffffff;\n  box-shadow: -2px 0 4px rgba(0, 0, 0, 0.05);\n}\n\n.dynamic-table th.sticky-right-col {\n  z-index: 14;\n}\n\n/* Adjust shadows for better visibility */\n.dynamic-table tbody tr:hover td.hierarchy-cell,\n.dynamic-table tbody tr:hover td.sticky-right-col {\n  background: #f9fafb;\n}\n\n.dynamic-table thead tr {\n  border-bottom: 1px solid var(--color-border);\n}\n\n.dynamic-table th {\n  padding: 10px 12px;\n  text-align: left;\n  font-weight: 600;\n  font-size: 12px;\n  color: var(--color-text-secondary);\n  text-transform: uppercase;\n  letter-spacing: 0.3px;\n  white-space: nowrap;\n  background: var(--color-bg-primary);\n  border-right: 1px solid #e5e7eb;\n}\n\n.dynamic-table th:last-child {\n  border-right: none;\n}\n\n/* Group header row styling */\n.group-header-row th {\n  padding: 8px 12px;\n  font-size: 13px;\n  font-weight: 700;\n  border-bottom: 1px solid #d1d5db;\n}\n\n/* FNAC group styling */\nth[data-group*=\"FNAC\"] {\n  background-color: #fde68a !important;\n  color: #92400e !important;\n}\n\n/* DARTY group styling */\nth[data-group*=\"DARTY\"] {\n  background-color: #ef4444 !important;\n  color: #ffffff !important;\n}\n\n/* Total group styling */\nth[data-group*=\"Total\"],\nth[data-group*=\"général\"] {\n  background-color: #e5e7eb !important;\n  color: #374151 !important;\n}\n\n.hierarchy-header {\n  min-width: 180px;\n  max-width: 280px;\n  padding-left: var(--spacing-md) !important;\n  text-align: left !important;\n  background: #ffffff !important;\n  font-weight: 600 !important;\n  white-space: nowrap;\n}\n\n.measure-header {\n  text-align: right !important;\n  min-width: 80px;\n  max-width: 130px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.measure-header.sortable {\n  cursor: pointer;\n  user-select: none;\n  transition: background-color 0.15s ease;\n}\n\n.measure-header.sortable:hover {\n  filter: brightness(0.95);\n}\n\n.measure-header.sortable:active {\n  filter: brightness(0.9);\n}\n\n.sort-indicator {\n  font-size: 10px;\n  opacity: 0.3;\n  transition: opacity 0.15s ease;\n}\n\n/* Body Styles */\n.dynamic-table tbody tr {\n  transition: background-color var(--transition-speed) ease;\n  border-bottom: 1px solid #f3f4f6;\n}\n\n.dynamic-table tbody tr:hover {\n  background-color: #fafafa;\n}\n\n.dynamic-table tbody tr:last-child {\n  border-bottom: 1px solid var(--color-border);\n}\n\n/* Subtotal Row Styles */\n.subtotal-row {\n  background: #f9fafb !important;\n  font-weight: 600;\n  border-top: 2px solid #d1d5db !important;\n  border-bottom: 2px solid #d1d5db !important;\n}\n\n.subtotal-row:hover {\n  background: #f3f4f6 !important;\n}\n\n.subtotal-cell {\n  font-weight: 600 !important;\n  color: #374151 !important;\n}\n\n.subtotal-label {\n  font-weight: 600;\n  font-style: italic;\n  color: #6b7280;\n}\n\n/* Cell Styles */\n.dynamic-table td {\n  padding: 6px 8px;\n  font-size: 12px;\n  color: var(--color-text-primary);\n  white-space: nowrap;\n}\n\n.dynamic-table th {\n  padding: 8px;\n  font-size: 12px;\n}\n\n/* Hierarchy Cell */\n.hierarchy-cell {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding-left: 8px !important;\n  background: #ffffff;\n  white-space: nowrap;\n  max-width: 280px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.indent {\n  display: inline-block;\n  flex-shrink: 0;\n}\n\n.expander {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 14px;\n  height: 14px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  font-size: 9px;\n  border-radius: 2px;\n  transition: all var(--transition-speed) ease;\n  flex-shrink: 0;\n}\n\n.expander:hover {\n  background-color: var(--color-bg-secondary);\n  color: var(--color-text-primary);\n}\n\n.expander.expanded {\n  color: var(--color-text-primary);\n}\n\n.expander.collapsed {\n  color: var(--color-text-secondary);\n}\n\n.expander-spacer {\n  display: inline-block;\n  width: 20px;\n  flex-shrink: 0;\n}\n\n.node-label {\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Level-based indentation styling */\n.level-0 .node-label {\n  font-weight: 600;\n  font-size: 13px;\n  color: var(--color-text-primary);\n}\n\n.level-1 .node-label {\n  font-weight: 500;\n  font-size: 13px;\n}\n\n.level-2 .node-label {\n  font-weight: 400;\n  font-size: 13px;\n  color: var(--color-text-secondary);\n}\n\n/* Measure Cell */\n.measure-cell {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n  white-space: nowrap;\n  font-weight: 400;\n}\n\n.measure-cell .value {\n  margin-right: var(--spacing-xs);\n}\n\n/* Change Badge (Boxed Evolution Indicator) */\n.change-badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 3px 6px;\n  border-radius: 3px;\n  font-size: 11px;\n  font-weight: 600;\n  white-space: nowrap;\n}\n\n.change-badge.positive {\n  background-color: var(--color-positive-bg);\n  color: var(--color-positive);\n}\n\n.change-badge.negative {\n  background-color: var(--color-negative-bg);\n  color: var(--color-negative);\n}\n\n.change-badge.neutral {\n  background-color: #f3f4f6;\n  color: var(--color-neutral);\n}\n\n/* Arrows in badges */\n.badge-arrow {\n  font-size: 11px;\n  line-height: 1;\n}\n\n/* Legacy positive/negative without badge */\n.measure-cell.positive:not(:has(.change-badge)) {\n  color: var(--color-positive);\n}\n\n.measure-cell.negative:not(:has(.change-badge)) {\n  color: var(--color-negative);\n}\n\n/* Remove bounce animations for minimalistic style */\n\n/* Clickable cells (with drill) */\n.measure-cell.clickable {\n  cursor: pointer;\n  position: relative;\n}\n\n.measure-cell.clickable:hover {\n  background-color: var(--color-bg-secondary);\n}\n\n/* Empty State */\n.empty-state {\n  padding: var(--spacing-lg);\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 13px;\n  font-weight: 400;\n}\n\n/* Loading State */\n.loading {\n  padding: var(--spacing-lg);\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 13px;\n}\n\n/* Scrollbar Styling */\n.dynamic-table-container::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-track {\n  background: var(--color-bg-secondary);\n  border-radius: 4px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-thumb {\n  background: var(--color-border);\n  border-radius: 4px;\n}\n\n.dynamic-table-container::-webkit-scrollbar-thumb:hover {\n  background: var(--color-text-secondary);\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n  .dynamic-table-container {\n    padding: var(--spacing-sm);\n  }\n\n  .dynamic-table th,\n  .dynamic-table td {\n    padding: var(--spacing-sm) var(--spacing-xs);\n    font-size: 12px;\n  }\n\n  .hierarchy-header {\n    min-width: 150px;\n  }\n\n  .measure-header {\n    min-width: 80px;\n  }\n}\n\n/* Pagination Styles */\n.pagination-controls {\n  padding: 12px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-top: 1px solid var(--color-border);\n  font-size: 13px;\n  color: var(--color-text-secondary);\n  background: transparent;\n}\n\n.pagination-button {\n  padding: 6px 12px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  background: #ffffff;\n  color: var(--color-text-primary);\n  font-size: 13px;\n  font-weight: 500;\n  transition: all 0.15s ease;\n}\n\n.pagination-button:hover:not(:disabled) {\n  background: var(--color-bg-secondary);\n  border-color: var(--color-primary);\n}\n\n.pagination-button:disabled {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n\n/* Print Styles */\n@media print {\n  .dynamic-table-container {\n    overflow: visible;\n  }\n\n  .dynamic-table {\n    box-shadow: none;\n  }\n\n  .expander {\n    display: none;\n  }\n  \n  .pagination-controls {\n    display: none;\n  }\n}\n"],sourceRoot:""}]);const l=i},540:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},659:n=>{var e={};n.exports=function(n,t){var o=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},788:(n,e,t)=>{t.r(e),t.d(e,{default:()=>m});var o=t(72),r=t.n(o),a=t(825),i=t.n(a),l=t(659),s=t.n(l),c=t(56),A=t.n(c),d=t(540),p=t.n(d),h=t(113),g=t.n(h),u=t(365),C={};C.styleTagTransform=g(),C.setAttributes=A(),C.insert=s().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=p(),r()(u.A,C);const m=u.A&&u.A.locals?u.A.locals:void 0},825:n=>{n.exports=function(n){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(o,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}}},e={};function t(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={id:o,exports:{}};return n[o](a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.nc=void 0;var o={};return(()=>{var n=o;Object.defineProperty(n,"__esModule",{value:!0}),t(788);class e{static isChangeField(n,e){const t=(n+" "+e).toLowerCase();return["delta","δ","Δ","change","var","evolution","diff"].some(n=>t.includes(n.toLowerCase()))}static isPercentageField(n,e){const t=(n+" "+e).toLowerCase();return["percent","%","pct","poids","rate","ratio"].some(n=>t.includes(n.toLowerCase()))}static isCurrencyField(n,e){const t=(n+" "+e).toLowerCase();return["amount","revenue","price","cost","ca "," ca","sales"].some(n=>t.includes(n.toLowerCase()))}static formatValue(n,e,t,o){if(null==n)return"-";const r="number"==typeof n?n:parseFloat(n);return isNaN(r)?String(n):this.isPercentageField(t,o)?`${r.toFixed(1)}%`:this.isCurrencyField(t,o)?new Intl.NumberFormat("fr-FR",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(r):e.is_numeric?new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:2}).format(r):String(n)}static getValueClass(n,e,t,o){const r="number"==typeof n?n:parseFloat(n);return isNaN(r)||!this.isChangeField(t,o)?"":r>=0?"positive":"negative"}static getTrendArrow(n){const e="number"==typeof n?n:parseFloat(n);return isNaN(e)?"→":e>0?"↗":e<0?"↘":"→"}static createChangeBadge(n,e,t,o){const r="number"==typeof n?n:parseFloat(n);if(isNaN(r)||!this.isChangeField(t,o))return"";const a=this.formatValue(n,e,t,o);return`<span class="change-badge ${r>=0?"positive":"negative"}"><span class="badge-arrow">${this.getTrendArrow(r)}</span>${a}</span>`}}class r{static buildHierarchy(n,e){var t,o;if(0===e.length)return n.map((n,e)=>({key:`row-${e}`,data:n,children:[],level:0,expanded:!1}));const r=[],a=new Map;for(const i of n){let n=r,l="";for(let r=0;r<e.length;r++){const s=e[r],c=null!==(o=null===(t=i[s.name])||void 0===t?void 0:t.value)&&void 0!==o?o:"",A=`${l}/${c}`;let d=a.get(A);d||(d={key:A,value:c,label:String(c),data:i,children:[],level:r,expanded:!1,isDimension:!0,dimensionField:s.name},a.set(A,d),n.push(d)),r<e.length-1&&(n=d.children),l=A}}return r}static flattenVisibleNodes(n,e=0){const t=[];return n.forEach(n=>{t.push(Object.assign(Object.assign({},n),{level:e})),n.expanded&&n.children&&n.children.length>0&&t.push(...this.flattenVisibleNodes(n.children,e+1))}),t}}class a{constructor(n){this.allExpanded=!1,this.pivotInfo=[],this.hasLoggedDataStructure=!1,this.sortStates=[],this.currentPage=1,this.rowsPerPage=200,this.totalRows=0,this.visibleNodes=[],this.table=null,this.thead=null,this.tbody=null,this.controlsContainer=null,this.paginationContainer=null,this.container=n,this.hierarchyNodes=[],this.fields=[],this.dimensionFields=[],this.measureFields=[],this.config={},this.allExpanded=!1,this.pivotInfo=[],this.hasLoggedDataStructure=!1,this.sortStates=[],this.currentPage=1,this.rowsPerPage=200,this.totalRows=0}setData(n,e,t,o,r,a=[]){this.hierarchyNodes=n,this.fields=e,this.dimensionFields=t,this.measureFields=o,this.config=r,this.pivotInfo=a,this.sortStates=[],this.rebuildVisibleNodes()}rebuildVisibleNodes(){const n=[],e=t=>{t.forEach(t=>{n.push(t),t.expanded&&t.children&&t.children.length>0&&e(t.children)})};e(this.hierarchyNodes),this.visibleNodes=n}render(){requestAnimationFrame(()=>{this.container.innerHTML="",this.container.className="dynamic-table-container",this.controlsContainer=this.renderControls(),this.container.appendChild(this.controlsContainer);const n=document.createElement("div");n.className="table-wrapper",this.table=document.createElement("table"),this.table.className="dynamic-table",this.thead=this.renderHeader(),this.table.appendChild(this.thead),this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),n.appendChild(this.table),this.container.appendChild(n),this.paginationContainer=document.createElement("div"),this.container.appendChild(this.paginationContainer),this.update()})}update(){if(!this.tbody||!this.controlsContainer||!this.paginationContainer)return;const n=performance.now();requestAnimationFrame(()=>{this.updateControls();const e=performance.now(),t=this.renderBody();this.tbody.replaceWith(t),this.tbody=t;const o=performance.now();console.log(`[Perf] renderBody execution time: ${(o-e).toFixed(2)} ms`),this.paginationContainer.innerHTML="";const r=this.renderPaginationControls();this.paginationContainer.appendChild(r),this.updateSortIndicators();const a=performance.now();console.log(`[Perf] TableRenderer.update execution time: ${(a-n).toFixed(2)} ms`)})}updateControls(){if(!this.controlsContainer)return;const n=this.controlsContainer.querySelector(".expand-toggle-icon"),e=this.controlsContainer.querySelector(".expand-toggle-text");n&&(n.textContent=this.allExpanded?"▼":"▶"),e&&(e.textContent=this.allExpanded?"Réduire tout":"Développer tout")}renderControls(){const n=document.createElement("div");n.className="table-controls";const e=document.createElement("button");e.className="expand-toggle";const t=document.createElement("span");t.className="expand-toggle-icon",t.textContent=this.allExpanded?"▼":"▶";const o=document.createElement("span");return o.className="expand-toggle-text",o.textContent=this.allExpanded?"Réduire tout":"Développer tout",e.appendChild(t),e.appendChild(o),e.onclick=()=>{this.allExpanded=!this.allExpanded,this.toggleAllNodes(this.hierarchyNodes,this.allExpanded),this.currentPage=1,this.update()},n.appendChild(e),n}toggleAllNodes(n,e){n.forEach(n=>{n.children&&n.children.length>0&&(n.expanded=e,this.toggleAllNodes(n.children,e))}),this.rebuildVisibleNodes()}renderHeader(){const n=document.createElement("thead"),e=this.detectColumnGroups();if(e.length>0){const t=this.renderGroupHeaderRow(e);n.appendChild(t)}const t=document.createElement("tr"),o=document.createElement("th");return o.className="hierarchy-header",this.dimensionFields.length>0?o.textContent=this.dimensionFields[0].label_short||this.dimensionFields[0].label:o.textContent=this.config.hierarchy_label||"Hiérarchie",e.length>0&&(o.rowSpan=2),t.appendChild(o),this.measureFields.forEach((n,e)=>{const o=document.createElement("th");o.className="measure-header sortable",o.style.cursor="pointer",o.style.userSelect="none","$$$_row_total_$$$"===n.pivot_key&&o.classList.add("sticky-right-col");const r=this.extractGroupName(n.name,n.label,n);if(r){o.dataset.group=r,o.style.backgroundColor=this.getGroupColor(r);const n=r.toLowerCase();n.includes("fnac")?o.style.color="#92400e":n.includes("darty")?o.style.color="#ffffff":(n.includes("total")||n.includes("général"))&&(o.style.color="#374151")}const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="6px";const i=document.createElement("span");i.textContent=n.label_short||n.label,i.title=n.label,a.appendChild(i);const l=document.createElement("span");l.className="sort-indicator",l.style.opacity="0.3",l.style.fontSize="9px",l.textContent="⇅",a.appendChild(l),o.appendChild(a),o.onclick=e=>{this.handleSort(n.name,e.shiftKey)},t.appendChild(o)}),n.appendChild(t),n}detectColumnGroups(){const n=new Map;return this.measureFields.forEach(e=>{const t=this.extractGroupName(e.name,e.label,e);t&&n.set(t,(n.get(t)||0)+1)}),Array.from(n.entries()).map(([n,e])=>({name:n,count:e}))}extractGroupName(n,e,t){if(t&&t.pivot_label)return t.pivot_label;const o=`${n} ${e}`.toLowerCase(),r=(e||"").toLowerCase(),a=(n||"").toLowerCase();return o.includes("fnac")||r.startsWith("fnac")||a.includes("fnac")?"FNAC":o.includes("darty")||r.startsWith("darty")||a.includes("darty")?"DARTY":o.includes("total")||o.includes("général")||o.includes("general")?"Total général":""}getGroupColor(n){const e=n.toLowerCase();return e.includes("fnac")?"#fde68a":e.includes("darty")?"#ef4444":e.includes("total")||e.includes("général")?"#e5e7eb":"transparent"}renderGroupHeaderRow(n){const e=document.createElement("tr");if(e.className="group-header-row",(this.dimensionFields.length>0?1:0)>0){const n=document.createElement("th");n.className="group-header-spacer",n.style.border="none",n.style.backgroundColor="transparent",e.appendChild(n)}return n.forEach(n=>{const t=document.createElement("th");t.className="group-header",t.colSpan=n.count,t.textContent=n.name,t.style.backgroundColor=this.getGroupColor(n.name),t.style.fontWeight="700",t.style.textAlign="center",t.style.fontSize="13px",t.style.padding="10px 12px";const o=n.name.toLowerCase();o.includes("fnac")?t.style.color="#92400e":o.includes("darty")?t.style.color="#ffffff":t.style.color="#374151",e.appendChild(t)}),e}renderBody(){const n=document.createElement("tbody");this.config.show_subtotals,this.totalRows=this.visibleNodes.length;const e=(this.currentPage-1)*this.rowsPerPage,t=e+this.rowsPerPage,o=this.visibleNodes.slice(e,t),r=document.createDocumentFragment();if(o.forEach(n=>{const e=this.renderRow(n);r.appendChild(e)}),n.appendChild(r),0===this.hierarchyNodes.length){const e=document.createElement("tr"),t=document.createElement("td");t.colSpan=this.measureFields.length+1,t.className="empty-state",t.textContent="Aucune donnée disponible",e.appendChild(t),n.appendChild(e)}return n}renderRow(n){const e=document.createElement("tr");e.className=`level-${n.level}`,e.dataset.key=n.key;const t=document.createElement("td");t.className="hierarchy-cell";const o=document.createElement("span");if(o.className="indent",o.style.width=24*n.level+"px",t.appendChild(o),n.children&&n.children.length>0){const e=document.createElement("span");e.className="expander "+(n.expanded?"expanded":"collapsed"),e.textContent=n.expanded?"▼":"▶",e.onclick=e=>{e.stopPropagation(),this.toggleNode(n)},t.appendChild(e)}else{const n=document.createElement("span");n.className="expander-spacer",t.appendChild(n)}const r=document.createElement("span");return r.className="node-label",r.textContent=n.label||"-",t.appendChild(r),e.appendChild(t),this.measureFields.forEach(t=>{const o=this.renderMeasureCell(n.data,t);"$$$_row_total_$$$"===t.pivot_key&&o.classList.add("sticky-right-col"),e.appendChild(o)}),e}renderMeasureCell(n,t){const o=document.createElement("td");let r,a;o.className="measure-cell";const i=t.pivot_key;if(i){const e=t.name.split(".").slice(0,-1).join(".");if("$$$_row_total_$$$"===i){const t=n[e];t&&"object"==typeof t&&(r=t[i]||t.$$$_row_total_$$$),r||(r=n[`${e}.$$$_row_total_$$$`],r||(r=n[e]))}else{const o=n[e];r=o&&"object"==typeof o?o[i]:n[t.name]}}else r=n[t.name];if(a=null==r?void 0:r.value,e.isChangeField(t.name,t.label)){const n=e.createChangeBadge(a,t,t.name,t.label);n?o.innerHTML=n:o.textContent="-"}else{const n=e.formatValue(a,t,t.name,t.label),r=document.createElement("span");r.className="value",r.textContent=n,o.appendChild(r)}return(null==r?void 0:r.links)&&r.links.length>0&&(o.classList.add("clickable"),o.onclick=n=>{"undefined"!=typeof LookerCharts&&LookerCharts.Utils.openDrillMenu({links:r.links,event:n})}),o}toggleNode(n){n.expanded=!n.expanded,this.currentPage=1;const e=this.visibleNodes.findIndex(e=>e.key===n.key);if(-1===e)return this.rebuildVisibleNodes(),void this.update();if(n.expanded){const t=n.children||[];this.visibleNodes.splice(e+1,0,...t)}else{let t=0;const o=n=>{t+=n.length,n.forEach(n=>{n.expanded&&n.children&&n.children.length>0&&o(n.children)})};o(n.children||[]),this.visibleNodes.splice(e+1,t)}this.update()}handleSort(n,e){const t=this.sortStates.find(e=>e.fieldName===n);if(e)if(t)"asc"===t.direction?t.direction="desc":this.sortStates=this.sortStates.filter(e=>e.fieldName!==n);else{const e=Math.max(...this.sortStates.map(n=>n.priority),-1);this.sortStates.push({fieldName:n,direction:"asc",priority:e+1})}else t?"asc"===t.direction?(t.direction="desc",this.sortStates=[t]):this.sortStates=[]:this.sortStates=[{fieldName:n,direction:"asc",priority:0}];this.sortStates.forEach((n,e)=>n.priority=e),this.applySorts(),this.rebuildVisibleNodes(),this.update()}applySorts(){if(0===this.sortStates.length)return;const n=e=>{e.sort((n,e)=>{for(const t of this.sortStates.sort((n,e)=>n.priority-e.priority)){const o=this.getNodeValue(n.data,t.fieldName),r=this.getNodeValue(e.data,t.fieldName),a=this.compareValues(o,r);if(0!==a)return"asc"===t.direction?a:-a}return 0}),e.forEach(e=>{e.children&&e.children.length>0&&n(e.children)})};n(this.hierarchyNodes)}getNodeValue(n,e){var t;const o=e.split("."),r=o[o.length-1],a=o.slice(0,-1).join(".");if("$$$_row_total_$$$"===r){let e=n[`${a}.$$$_row_total_$$$`];if(e||(e=n[a]),!e){const t=n[a];t&&"object"==typeof t&&(e=t[r]||t.$$$_row_total_$$$)}return null==e?void 0:e.value}const i=n[a];if(i&&"object"==typeof i&&i[r])return null===(t=i[r])||void 0===t?void 0:t.value;const l=n[e];return null==l?void 0:l.value}compareValues(n,e){if(null==n&&null==e)return 0;if(null==n)return 1;if(null==e)return-1;if("number"==typeof n&&"number"==typeof e)return n-e;const t=parseFloat(n),o=parseFloat(e);return isNaN(t)||isNaN(o)?String(n).localeCompare(String(e)):t-o}updateSortIndicators(){this.container.querySelectorAll(".measure-header").forEach((n,e)=>{const t=this.measureFields[e];if(!t)return;const o=this.sortStates.find(n=>n.fieldName===t.name),r=n.querySelector(".sort-indicator");r&&(o?(r.style.opacity="1",r.textContent="asc"===o.direction?"↑":"↓",this.sortStates.length>1&&(r.textContent+=` ${o.priority+1}`)):(r.style.opacity="0.3",r.textContent="⇅"))})}renderSubtotalRow(n){const t=document.createElement("tr");t.className=`subtotal-row level-${n.level}`;const o=document.createElement("td");o.className="hierarchy-cell subtotal-cell";const r=document.createElement("span");r.className="indent",r.style.width=24*(n.level+1)+"px",o.appendChild(r);const a=document.createElement("span");return a.className="subtotal-label",a.textContent=`Sous-total ${n.label}`,o.appendChild(a),t.appendChild(o),this.measureFields.forEach(o=>{const r=document.createElement("td");r.className="measure-cell subtotal-cell";const a=this.calculateSubtotal(n,o.name);if(e.isChangeField(o.name,o.label)){const n=e.createChangeBadge(a,o,o.name,o.label);n?r.innerHTML=n:r.textContent="-"}else{const n=e.formatValue(a,o,o.name,o.label),t=document.createElement("span");t.className="value",t.textContent=n,r.appendChild(t)}t.appendChild(r)}),t}calculateSubtotal(n,t){if(!n.children||0===n.children.length)return null;const o=n=>{const e=[];return n.forEach(n=>{if(n.children&&n.children.length>0)e.push(...o(n.children));else{const o=this.getNodeValue(n.data,t);null==o||isNaN(parseFloat(o))||e.push(parseFloat(o))}}),e},r=o(n.children);if(0===r.length)return null;const a=e.isChangeField(t,""),i=e.isPercentageField(t,"");return a||i?r.reduce((n,e)=>n+e,0)/r.length:r.reduce((n,e)=>n+e,0)}renderPaginationControls(){const n=document.createElement("div");n.className="pagination-controls",n.style.padding="12px",n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.borderTop="1px solid var(--color-border)",n.style.fontSize="13px",n.style.color="var(--color-text-secondary)",n.style.background="transparent";const e=Math.ceil(this.totalRows/this.rowsPerPage);if(e<=1)return document.createDocumentFragment();const t=document.createElement("span");t.textContent=`Page ${this.currentPage} sur ${e} (${this.totalRows} lignes)`;const o=document.createElement("div");o.style.display="flex",o.style.gap="8px";const r=document.createElement("button");r.textContent="Précédent",r.disabled=1===this.currentPage,r.className="pagination-button",r.style.padding="6px 12px",r.style.border="1px solid var(--color-border)",r.style.borderRadius="var(--border-radius)",r.style.cursor=1===this.currentPage?"not-allowed":"pointer",r.style.background="#ffffff",r.style.color="var(--color-text-primary)",r.style.fontSize="13px",r.style.opacity=1===this.currentPage?"0.5":"1",r.onclick=()=>{this.currentPage>1&&(this.currentPage--,this.update())};const a=document.createElement("button");return a.textContent="Suivant",a.disabled=this.currentPage===e,a.className="pagination-button",a.style.padding="6px 12px",a.style.border="1px solid var(--color-border)",a.style.borderRadius="var(--border-radius)",a.style.cursor=this.currentPage===e?"not-allowed":"pointer",a.style.background="#ffffff",a.style.color="var(--color-text-primary)",a.style.fontSize="13px",a.style.opacity=this.currentPage===e?"0.5":"1",a.onclick=()=>{this.currentPage<e&&(this.currentPage++,this.update())},o.appendChild(r),o.appendChild(a),n.appendChild(t),n.appendChild(o),n}}let i=null,l=null;const s={id:"dynamic-table-viz",label:"Dynamic Hierarchical Table",options:{hierarchy_label:{type:"string",label:"Hierarchy Column Label",default:"Hierarchy",section:"Style",order:1},max_hierarchy_levels:{type:"number",label:"Max Hierarchy Levels",default:10,section:"Data",order:2},auto_expand_level:{type:"number",label:"Auto Expand to Level",default:0,section:"Data",order:3},show_totals:{type:"boolean",label:"Show Totals Row",default:!1,section:"Data",order:4},show_subtotals:{type:"boolean",label:"Show Subtotal Rows",default:!1,section:"Data",order:5},color_positive:{type:"string",label:"Positive Change Color",default:"#10b981",section:"Colors",display:"color",order:6},color_negative:{type:"string",label:"Negative Change Color",default:"#ef4444",section:"Colors",display:"color",order:7}},create(n,e){n.innerHTML='<div class="loading-viz">Chargement de la visualisation...</div>',n.style.width="100%",n.style.height="100%",n.style.overflow="auto"},async updateAsync(n,e,t,o,s){const A=performance.now(),d=function(n,e,t){if(!l)return!0;if(n.length!==l.data.length)return!0;const o=Object.keys(e);if(o.length!==Object.keys(l.config).length)return!0;for(const n of o)if(e[n]!==l.config[n])return!0;return JSON.stringify({d:t.fields.dimension_like.map(n=>n.name),m:t.fields.measure_like.map(n=>n.name),t:t.fields.table_calculations.map(n=>n.name)})!==JSON.stringify({d:l.queryResponse.fields.dimension_like.map(n=>n.name),m:l.queryResponse.fields.measure_like.map(n=>n.name),t:l.queryResponse.fields.table_calculations.map(n=>n.name)})}(n,t,o);try{if(e.innerHTML="",e.style.width="100%",e.style.height="100%",e.style.overflow="auto",!o||!n||0===n.length)return void(e.innerHTML='<div class="empty-state">Aucune donnée à afficher</div>');const s=o.fields.dimension_like||[],A=[...o.fields.measure_like||[],...o.fields.table_calculations||[]],p=[...s,...A],h=o.pivots;let g=A,u=[];if(h&&h.length>0){const e=performance.now(),t=A.filter((n,e,t)=>e===t.findIndex(e=>e.name===n.name)),o=performance.now();console.log(`[Perf] Deduplicate measures time: ${(o-e).toFixed(2)} ms`);const r=t[0];n[0],r&&h.some(n=>r.name.includes(`.${n.key}`))?(g=t.map(n=>{let e=null,t=null;for(const o of h)if(n.name.includes(`.${o.key}`)||n.name.endsWith(`.${o.key}`)){e=o.key,t="$$$_row_total_$$$"===o.key?"Total général":o.key;break}return Object.assign(Object.assign({},n),{pivot_key:e,pivot_label:t,is_pivoted:!0})}),u=h.map(n=>({key:n.key,label:"$$$_row_total_$$$"===n.key?"Total général":n.key}))):(g=[],u=h.map(n=>({key:n.key,label:"$$$_row_total_$$$"===n.key?"Total général":n.key})),h.forEach(n=>{t.forEach(e=>{const t="$$$_row_total_$$$"===n.key?"Total général":n.key;g.push(Object.assign(Object.assign({},e),{name:`${e.name}.${n.key}`,label:`${t} ${e.label_short||e.label}`,label_short:e.label_short||e.label,pivot_key:n.key,pivot_label:t,is_pivoted:!0}))})}))}if(0===p.length)return void(e.innerHTML='<div class="empty-state">No fields available</div>');if(t.color_positive&&e.style.setProperty("--color-positive",t.color_positive),t.color_negative&&e.style.setProperty("--color-negative",t.color_negative),d||!i){const e=performance.now();i=r.buildHierarchy(n,s);const t=performance.now();console.log(`[Perf] HierarchyBuilder.buildHierarchy execution time: ${(t-e).toFixed(2)} ms`)}const C=i,m=t.auto_expand_level||0;m>0&&c(C,m);const f=new a(e);f.setData(C,p,s,g,t,u);const b=performance.now();f.render();const y=performance.now();console.log(`[Perf] TableRenderer.render execution time: ${(y-b).toFixed(2)} ms`),l={data:n,config:t,queryResponse:o}}catch(n){console.error("❌ Error rendering visualization:",n),e.innerHTML=`<div class="error-state">Erreur lors du rendu: ${(null==n?void 0:n.message)||"Unknown error"}</div>`}finally{const n=performance.now();console.log(`[Perf] updateAsync total execution time: ${(n-A).toFixed(2)} ms`)}}};function c(n,e,t=0){t>=e||n.forEach(n=>{n.children&&n.children.length>0&&(n.expanded=!0,c(n.children,e,t+1))})}window.looker.plugins.visualizations.add(s),n.default=s})(),o})());
//# sourceMappingURL=dynamic_table.js.map